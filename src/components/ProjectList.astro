---
import type { CollectionEntry } from "astro:content";
import StatusIcon from "@/components/StatusIcon.astro";

const { projects } = Astro.props;
type Project = CollectionEntry<"projects">;
---

{
  projects.length > 0 &&
    projects.map((project: Project) => (
      <div class="mb-8 rounded-sm border border-[#333] bg-[#2a2a2a] p-8 transition-colors duration-300 ease-in-out hover:border-[#89b29ee6]">
        <h3>
          >
          {project.data.siteUrl ? (
            <a
              href={project.data.siteUrl}
              target="_blank"
              title={`Visit ${project.data.name} website`}
              rel="noopener"
              class="text-[1.5rem] font-semibold text-[#89b29ee6] hover:underline"
            >
              {project.data.name}
            </a>
          ) : (
            <span class="text-[1.5rem] font-semibold text-[#89b29ee6]">
              {project.data.name}
            </span>
          )}
          {project.data.status.length > 0
            ? project.data.status.map((status) => (
                <span class="ml-2 align-middle">
                  <StatusIcon status={status} />
                </span>
              ))
            : null}
        </h3>
        <p class="mb-6 text-[#bbb]" set:html={project.data.description} />
        <div
          class="relative mx-0 my-6 flex items-center gap-4 rounded-sm border border-[#444] bg-[#1a1a1a] p-4"
          role="group"
          aria-label={`Installation command for ${project.data.name}`}
        >
          <code
            class="scrollbar-hide flex flex-1 items-center overflow-x-auto bg-none text-[0.9rem] whitespace-nowrap text-[#89b29ee6] lg:overflow-visible"
            aria-label="Installation command"
            style="scrollbar-width: none; -ms-overflow-style: none;"
          >
            {project.data.installCommand}
          </code>
          <button
            class="ml-8 flex shrink-0 cursor-pointer items-center justify-center rounded border border-[#555] bg-[#333] px-4 py-2 text-[0.75rem] text-[#bbb] transition-colors hover:bg-[#444] hover:text-white"
            onclick={`navigator.clipboard.writeText('${project.data.installCommand}')`}
            title="Copy to clipboard"
            aria-label="Copy installation command to clipboard"
          >
            <i class="nf nf-md-content_copy" />
          </button>
        </div>
        {project?.data.sourceUrl || project?.data.manualUrl ? (
          <p class="text-[0.875rem] text-[#bbb] italic">
            The{" "}
            {project.data.sourceUrl && (
              <a
                href={project.data.sourceUrl}
                target="_blank"
                title={`View ${project.data.name} source code on GitHub`}
                rel="noopener"
              >{`source code`}</a>
            )}{" "}
            {project?.data.sourceUrl && project?.data.manualUrl ? "and" : null}{" "}
            {project.data.manualUrl && (
              <a
                href={project.data.manualUrl}
                target="_blank"
                title={`View ${project.data.name} manual`}
                rel="noopener"
              >
                {`manual`}
              </a>
            )}{" "}
            {project?.data.sourceUrl && project?.data.manualUrl ? "are" : "is"}{" "}
            available.
          </p>
        ) : null}
      </div>
    ))
}
